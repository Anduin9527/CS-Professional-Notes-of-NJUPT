

## 引论

### 程序设计语言的翻译机制

1. 汇编程序：源语言是某种**汇编语言**，其目标语言是**机器语言**的**翻译程序**被称为汇编程序。汇编程序一般对源程序进行两遍扫描来完成翻译。第一遍进行**存储分配**，构造出第二遍扫描时用的各种表格；第二遍**用机器操作码代替源程序中的符号**

2. 编译程序：是将高级语言写的源程序翻译成目标语言（汇编语言、机器语言）的程序。这种翻译过程称为编译

3. 解释程序：将高级语言写的源程序作为输入数据，但并不产生目标程序，而是边解释边执行源程序本身的一种程序。解释程序主要优点是易于为用户提供调试功能，对源程序的语法分析及出错处理都很及时，修改调试也很方便，但是解释程序执行速度较慢，运行效率低。**跨平台**无需额外操作

#### 典型的翻译机制

1. `C`语言翻译机制：纯编译

   <img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/C%E8%AF%AD%E8%A8%80%E7%BF%BB%E8%AF%91%E6%9C%BA%E5%88%B6.png" alt="image-20220902204754550" style="zoom:67%;" />

   

2. `JAVA`翻译机制：先编译后解释

   <img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20220902204841.png" alt="image-20220902204841227" style="zoom:67%;" />

   

3. `C#`翻译机制：先编译再编译

   <img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20220902204941.png" alt="image-20220902204941370" style="zoom:67%;" />

   

从上述对源程序的处理过程可以看出现代高级程序设计语言编译程序的发展趋势：从“一次编译”非托管到“编译+解释”或“编译+编译”的二次托管。

### 编译程序概述

<img src="https://imgbed-1304793179.cos.ap-nanjing.myqcloud.com/typora/20220902205116.png" alt="image-20220902205116218" style="zoom:80%;" />

#### 编译程序流程

1. 词法分析
   1. 扫描源程序进行读符号，删除无用字符（如空格、注释等）
   2. 将一个个有独立意义的单词识别出来，并且转换成**统一长度的内部编码**
   3. 建立有关表格（如名字特征表、常数表），进行词法检查以供语法和语义分析用

2. 语法分析
   1. 将词法分析后所有单词组成句子，根据不同高级语言不同语法规则来分析这些句子乃至程序是否正确

3. 语义分析和中间代码生成
   1. 根据语义分析语句的含义，可将源程序表示成一种内部形式（中间语言）或直接生成目标程序
   2. 中间代码的形式有很多种，包含：后缀表达式、三元式、四元式等

4. 代码优化
   1. 生成中间代码的目标是为了实现代码优化，以便生成更高质量的目标代码

5. 目标代码生成
   1. 目标代码生成就是将中间语言代码转换成机器语言程序或汇编语言程序，最后完成翻译


#### 编译程序的前端和后端

与源语言相关的部分被称为编译前端，包括**词法分析、语法分析、语义分析及中间代码**生成3个阶段；与目标语言相关的部分被称为编译后端，包括**代码优化和目标代码生成**2个阶段。将编译程序划分为编译前端和编译后端，不仅有利于代码优化，而且对目标代码的生成和移植更有利。

1. 可以给同一个编译前端配不同的编译后端，这样就能在不同的计算机上构造出同一语言的编译程序。例如，`Java`
2. 可以给不同的编译前端配同一编译后端，这样就可以在同一计算机上生成多种语言的编译程序。例如，被广泛使用的`GCC`，其编译前端是多种程序设计语言的不同分析器。`GCC`以这些语言的源程序文件作为输入，经过词法分析、语法分
   析和语义分析，产生一种抽象语法树（Abstract Syntax Tree：AST）形式的中间代码；`GCC`的编译后端对**AST**形式的中间代码进行分析处理，最终产生目标代码。

#### 编译程序的分遍

+ 一遍扫描编译程序：

  在编译程序的工作过程中，词法分析、语法分析、语义分析及中间代码生成、代码优化、目标代码生成这5个阶段的工作可以只对源程序进行一次扫描，也可以对源程序或等价源程序进行若干次扫描。对源程序或等价源程序进行相关的加工处理工作，称为遍（Pass)。

+ 多遍扫描编译程序：

  把源程序分为几遍来编译，每遍只完成编译程序中的一部分或几部分工作，称为多遍的编译程序

  优点：加工充分；出错处理细致；目标程序质量高
  缺点：编译时间长，开销大

### 编译程序的构造方法

#### 编写编译程序的一般方法

1. 机器语言和汇编语言直接编写

   优点：针对具体机器，充分发挥计算机系统功能；生成的程序效率高

   缺点：难读难写；易出错、难维护；生产效率低

2. 使用高级语言进行编写
   并非所有高级语言都适合编写编译程序。能够编写编译程序或其他系统软件的高级语言称为**系统程序设计语言**。例如，`Pascal`、`C`、`C++`、`Java`等

3. 编译程序的自动生成

   源语言的定义以及机器语言的描述输入到软件中，自动生成该语言编译程序

   词法分析程序：`Lex`、`Flex`等

   语法分析程序：`Yacc`、`ANTLR`等

#### T型图